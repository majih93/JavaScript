# JavaScript가 싱글 스레드라는 것과 관련해서...

비동기 프로그래밍을 잘 이해하기 위해서 실행 컨텍스트를 공부하고, 실행 컨텍스트들을 execution context stack에 push/pop하는 형식으로 현재 실행 중인 코드의 순서와 환경을 관리하는 것을 배웠음.

JavaScript 엔진은 항상 오직 하나의 execution context stack을 가지고 동작한다고 하는데, 이게 JS엔진이 JavaScript를 싱글스레드로 동작시키는 것 때문에 이렇게 설계된 것일까 하는 생각이 들었다.

맞나?? 근데 이걸 좀 제대로 이해하려면 JavaScript가 싱글스레드라는 것이 무슨 소리인지 이해할 필요가 있다는 생각이 들었음.

JavaScript가 싱글스레드이다 라고 명시하는 문서나, 왜 싱글스레드인지 명확하게 알려주는 글이 없어서 나름대로 좀 관련 지식을 공부하면서 이유를 이해하는 시간이 필요할 것 같음.

역사적인 상황 상 간단하게 브라우저 dom을 조작할 스크립트 언어가 필요했고, 당시 JS는 지금처럼 복잡도와 성능이 높은 애플리케이션을 조작하고자 만들어진게 아니라는 점을 고려해서, 싱글스레드 vs 멀티스레드 중에서 왜 싱글 스레드 형식으로 설계하게 되었는지 추측 및 이해해보기.

# 일단 스레드가 뭔데?

싱글 스레드 vs 멀티 스레드의 장단점을 제대로 이해하기 위해서는 먼저 스레드가 뭔지 알아야 한다.

프로세스와 스레드를 항상 같이 생각하게 되는데,

프로세스 - 간단하게 말하면 실행 중인 프로그램
스레드 - 실행의 단위.

브라우저는 멀티 스레드로 동작하지만, JavaScript는 브라우저의 여러 스레드 중에서 main thread에서 동작한다.

하나의 main thread에서만 JavaScript 코드가 처리되기 때문에 한 번에 하나의 함수만 실행할 수 있음.

Call Stack에 접근해서 처리하는 프로세스가 하나구나.

# JS는 왜 싱글스레드로 고안되었는지?

브라우저에서 사용자 상호작용을 처리하려고 만들어짐.

싱글 스레드는 동시성 문제나 race condition, deadlock과 같은 멀티 스레딩 환경의 문제를 걱정할 필요가 없다.

그리고 여러 스레드가 DOM을 조작하면 불일치가 발생할 수 있음. UI를 일관되게 변경하는 것을 보장하기 위해서도 싱글스레드 구조가 맞음.

ECMAScript 자체는 JavaScript가 싱글 스레드로 동작하라고 명시하고 있지 않다고 함.

`At any point in time, there is at most one execution context per agent that is actually executing code.` ecma 262에는 이런 문장이 있음.

코드를 실행하는 execution context는 하나만 존재해야 한다.

# 사실 근데....

히히 아직 잘 모르겠네..ㅠ
